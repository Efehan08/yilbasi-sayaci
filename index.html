<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yƒ±lba≈üƒ± Geri Sayƒ±mƒ± - Y√ñNETMEN MODU</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lil-gui@0.17.0/dist/lil-gui.umd.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

        body {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(-45deg, #0f172a, #1a0b2e, #090979, #020024);
            background-size: 400% 400%;
            animation: auroraGradient 15s ease infinite;
            overflow: hidden; margin: 0;
        }
        @keyframes auroraGradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        #canvas-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; opacity: 1; pointer-events: none;
        }

        /* Y√úKLEME EKRANI */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.98); z-index: 100;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            color: #fbbf24; font-size: 24px; font-weight: bold; transition: opacity 0.5s;
            cursor: pointer;
        }

        /* I≈ûIKLAR */
        .icicle-lights-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 45; }
        .light-string { position: absolute; top: 0; width: 2px; background-color: rgba(255, 255, 255, 0.2); }
        .light-bulb-end { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 12px; height: 18px; border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; background: #fff; animation: flash 1.5s infinite alternate ease-in-out; }
        .light-bulb-end::before, .light-bulb-end::after { content: ''; position: absolute; left: 0; width: 100%; height: 100%; border-radius: inherit; background-color: inherit; box-shadow: inherit; opacity: 0.8; }
        .light-bulb-end::before { bottom: 40px; } .light-bulb-end::after { bottom: 80px; }
        .light-string:nth-child(5n+1) { height: 10vh; left: 5%; animation-delay: 0.1s; }
        .light-string:nth-child(5n+2) { height: 18vh; left: 20%; animation-delay: 0.5s; }
        .light-string:nth-child(5n+3) { height: 8vh; left: 35%; animation-delay: 1.2s; }
        .light-string:nth-child(5n+4) { height: 20vh; left: 50%; animation-delay: 0.3s; }
        .light-string:nth-child(5n+5) { height: 14vh; left: 65%; animation-delay: 0.8s; }
        .light-string:nth-child(n+6) { left: 12%; } .light-string:nth-child(n+11) { left: 28%; } .light-string:nth-child(n+16) { left: 42%; } .light-string:nth-child(n+21) { left: 58%; } .light-string:nth-child(n+26) { left: 75%; } .light-string:nth-child(n+31) { left: 85%; height: 16vh; } .light-string:nth-child(n+36) { left: 95%; height: 9vh; }
        .light-string:nth-child(4n+1) .light-bulb-end { background: #ff3333; color: #ff3333; box-shadow: 0 3px 10px #ff3333; } 
        .light-string:nth-child(4n+2) .light-bulb-end { background: #3366ff; color: #3366ff; box-shadow: 0 3px 10px #3366ff; } 
        .light-string:nth-child(4n+3) .light-bulb-end { background: #33ff33; color: #33ff33; box-shadow: 0 3px 10px #33ff33; } 
        .light-string:nth-child(4n+4) .light-bulb-end { background: #ffcc33; color: #ffcc33; box-shadow: 0 3px 10px #ffcc33; } 
        @keyframes flash { 0%, 100% { opacity: 1; filter: brightness(1.8); box-shadow: 0 3px 20px currentColor; transform: translateX(-50%) scale(1.1); } 50% { opacity: 0.5; filter: brightness(0.8); box-shadow: none; transform: translateX(-50%) scale(0.9); } }

        /* PANEL AYARI */
        .lil-gui { top: 70px !important; right: 10px !important; }

        .neon-box { box-shadow: 0 0 15px rgba(59, 130, 246, 0.2), inset 0 0 15px rgba(59, 130, 246, 0.1); border-color: rgba(59, 130, 246, 0.3) !important; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(5px); }
        .icy-headline { background: linear-gradient(to right, #ffffff, #cffafe, #38bdf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 20px rgba(56, 189, 248, 0.8)); display: inline-block; position: relative; z-index: 50; font-size: clamp(24px, 5vw, 60px); line-height: 1.2; }
        
        main { padding-top: 15vh !important; padding-bottom: 10vh !important; }
        @media (min-width: 1024px) { #headline-area { margin-bottom: 3vh !important; } .counter-container { margin-top: 0 !important; } }
        @media (max-width: 768px) { #headline-area { margin-bottom: 2rem; } .icy-headline { font-size: 24px; } .light-string { width: 1px; } .light-bulb-end { width: 8px; height: 12px; } main { padding-top: 10vh !important; } }
    </style>
</head>
<body class="h-screen w-full flex flex-col items-center justify-center text-white relative">

    <div id="loading-screen" onclick="forceOpen()">
        <div>üéõÔ∏è Y√ñNETMEN MODU A√áILIYOR...</div>
        <div style="font-size: 12px; color: #999; margin-top: 5px;">(A√ßƒ±lmazsa tƒ±klayƒ±n)</div>
        <button onclick="forceOpen()" class="mt-4 px-4 py-2 bg-blue-600 rounded text-white text-sm">BA≈ûLAT</button>
    </div>

    <div class="icicle-lights-container">
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div><div class="light-string"><div class="light-bulb-end"></div></div>
    </div>

    <div id="spotlight-overlay"></div>

    <div id="canvas-container" style="opacity: 1 !important;"></div>
    
    <button id="enableAudioBtn" onclick="enableAudio()" class="ui-layer absolute top-5 right-5 bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 text-white px-4 py-2 rounded-full text-xs transition">
        üéµ Sesi Aktif Et
    </button>

    <main class="ui-layer z-10 text-center px-4 w-full flex flex-col items-center justify-center h-full">
        <div id="headline-area" class="relative transition-all duration-1000 ease-in">
            <h1 id="headline" class="tracking-widest uppercase transition-colors duration-300 flex items-center justify-center">
                <span class="icy-headline font-black">Yeni Yƒ±la Kalan Zaman</span>
            </h1>
        </div>

        <div id="countdown" class="counter-container flex flex-wrap justify-center gap-4 md:gap-8 origin-center">
            <div id="box-days" class="neon-box flex flex-col items-center p-3 md:p-4 bg-white/5 rounded-xl md:rounded-2xl backdrop-blur-md border border-white/10 w-20 md:w-40 transition-all duration-500 cursor-default">
                <span id="days" class="digit text-2xl md:text-6xl font-black drop-shadow-lg">31</span>
                <span class="text-[10px] md:text-sm text-blue-200/70 mt-1 md:mt-2">G√úN</span>
            </div>
            <div id="box-hours" class="neon-box flex flex-col items-center p-3 md:p-4 bg-white/5 rounded-xl md:rounded-2xl backdrop-blur-md border border-white/10 w-20 md:w-40 transition-all duration-500 cursor-default">
                <span id="hours" class="digit text-2xl md:text-6xl font-black drop-shadow-lg">10</span>
                <span class="text-[10px] md:text-sm text-blue-200/70 mt-1 md:mt-2">SAAT</span>
            </div>
            <div id="box-minutes" class="neon-box flex flex-col items-center p-3 md:p-4 bg-white/5 rounded-xl md:rounded-2xl backdrop-blur-md border border-white/10 w-20 md:w-40 transition-all duration-500 cursor-default">
                <span id="minutes" class="digit text-2xl md:text-6xl font-black drop-shadow-lg">59</span>
                <span class="text-[10px] md:text-sm text-blue-200/70 mt-1 md:mt-2">DAKƒ∞KA</span>
            </div>
            <div id="box-seconds" class="neon-box flex flex-col items-center p-3 md:p-4 bg-white/5 rounded-xl md:rounded-2xl backdrop-blur-md border border-white/10 w-20 md:w-40 transition-all duration-500 cursor-default">
                <span id="seconds" class="digit text-2xl md:text-6xl font-black relative z-10 text-blue-400 drop-shadow-lg">00</span>
                <span class="text-[10px] md:text-sm text-blue-200/70 mt-1 md:mt-2 relative z-10">SANƒ∞YE</span>
            </div>
        </div>
    </main>

    <script>
        const targetDate = new Date("Jan 1, 2026 00:00:00").getTime();
        const gui = new lil.GUI({ title: 'Y√ñNETMEN PANELƒ∞' });
        
        // --- SENƒ∞N VERDƒ∞ƒûƒ∞N ALTIN DEƒûERLER (V27.3) ---
        const config = {
            // AƒûA√á (SOL)
            treeX: -22.15, treeY: -14.08, treeZ: 31.6, treeScale: 12.054,
            // KARDAN ADAM (SAƒû)
            snowX: 14.35, snowY: -9.68, snowZ: 41.4, snowScale: 6.615,
            // FENER
            lanternX: 10, lanternY: -10, lanternZ: 5, lanternScale: 6,
            // KAMERA
            camZ: 60.48
        };

        let scene, camera, renderer, treeGroup, snowmanGroup, lanternModel;
        let itemsLoaded = 0;
        const loadingScreen = document.getElementById('loading-screen');
        
        function forceOpen() {
            loadingScreen.style.opacity = 0;
            setTimeout(() => loadingScreen.style.display = 'none', 500);
        }
        window.addEventListener('load', function() { setTimeout(forceOpen, 3000); });

        function checkLoading() {
            itemsLoaded++;
            // T√ºm ana modeller (aƒüa√ß, kardan adam, fener, en az bir hediye) y√ºklendiƒüinde y√ºkleme ekranƒ±nƒ± kapat.
            // Bu sayƒ±, sahnedeki ana GLTF model sayƒ±sƒ±na g√∂re ayarlanmalƒ±.
            // 1 aƒüa√ß + 1 kardan adam g√∂vdesi + 1 kardan adam ≈üapkasƒ± + 1 fener + 1 hediye = 5
            if(itemsLoaded >= 5) forceOpen(); 
        }

        function loadGifts(treePos) {
            const loader = new THREE.GLTFLoader();
            const giftFiles = ['present-a-cube.glb', 'present-a-rectangle.glb', 'present-b-round.glb'];
            
            for(let i=0; i<4; i++) { 
                const randomFile = giftFiles[Math.floor(Math.random() * giftFiles.length)];
                loader.load(randomFile, function(gltf) {
                    const gift = gltf.scene;
                    gift.scale.set(4, 4, 4);
                    gift.position.set(treePos.x + (Math.random() * 5 - 2.5), -12, treePos.z + (Math.random() * 4 + 2)); 
                    gift.rotation.y = Math.random() * Math.PI;
                    scene.add(gift);
                    checkLoading(); // Her hediye y√ºklendiƒüinde sayacƒ± artƒ±r.
                });
            }
        }
        
        function initThreeJS() {
            const container = document.getElementById('canvas-container');
            scene = new THREE.Scene();

            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 2000);
            camera.position.set(0, 0, config.camZ);

            renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);

            const ambientLight = new THREE.AmbientLight(0xffffff, 3.0); scene.add(ambientLight);
            const dirLight = new THREE.DirectionalLight(0xffffff, 2.0); dirLight.position.set(50, 50, 50); scene.add(dirLight);

            // GUI SETUP
            const fTree = gui.addFolder('Aƒüa√ß (Sol)').open();
            const fSnow = gui.addFolder('Kardan Adam (Saƒü)').open();
            const fLamp = gui.addFolder('Fener').open();
            const fCam = gui.addFolder('Kamera').close();
            fCam.add(config, 'camZ', 10, 150).onChange(v => camera.position.z = v);

            const loader = new THREE.GLTFLoader();

            // 1. AƒûA√á (Orijinal Renkler)
            treeGroup = new THREE.Group(); scene.add(treeGroup);
            loader.load('tree-decorated-snow.glb', function(gltf) {
                const model = gltf.scene;
                // MATERYAL ZORLAMA KALDIRILDI
                treeGroup.add(model);
                treeGroup.position.set(config.treeX, config.treeY, config.treeZ);
                treeGroup.scale.set(config.treeScale, config.treeScale, config.treeScale);
                
                loadGifts(model.position);
                checkLoading();

                // GUI BAƒûLANTILARI
                fTree.add(config, 'treeX', -100, 0).name('Saƒü/Sol').onChange(v => treeGroup.position.x = v);
                fTree.add(config, 'treeY', -50, 10).name('Yukarƒ±/A≈üaƒüƒ±').onChange(v => treeGroup.position.y = v);
                fTree.add(config, 'treeZ', -50, 50).name('ƒ∞leri/Geri').onChange(v => treeGroup.position.z = v);
                fTree.add(config, 'treeScale', 1, 50).name('Boyut').onChange(v => treeGroup.scale.set(v,v,v));
            }, undefined, function(error) { console.error('Aƒüa√ß y√ºklenirken hata olu≈ütu:', error); checkLoading(); });

            // 2. KARDAN ADAM (Orijinal Renkler)
            snowmanGroup = new THREE.Group(); scene.add(snowmanGroup);
            loader.load('snowman.glb', function(gltf) {
                const model = gltf.scene;
                // MATERYAL ZORLAMA KALDIRILDI
                model.scale.set(config.snowScale, config.snowScale, config.snowScale);
                model.rotation.y = -0.8;
                snowmanGroup.add(model);
                checkLoading(); // Kardan adam g√∂vdesi y√ºklendi.

                loader.load('snowman-hat.glb', function(hat) {
                    hat.scene.scale.set(config.snowScale, config.snowScale, config.snowScale);
                    hat.scene.position.set(0, 7, 0); 
                    hat.scene.rotation.y = -0.8;
                    snowmanGroup.add(hat.scene);
                    checkLoading(); // Kardan adam ≈üapkasƒ± y√ºklendi.
                }, undefined, function(error) { console.error('Kardan adam ≈üapkasƒ± y√ºklenirken hata olu≈ütu:', error); checkLoading(); });
                
                snowmanGroup.position.set(config.snowX, config.snowY, config.snowZ);
                
                // GUI BAƒûLANTILARI
                fSnow.add(config, 'snowX', 0, 100).name('Saƒü/Sol').onChange(v => snowmanGroup.position.x = v);
                fSnow.add(config, 'snowY', -50, 10).name('Yukarƒ±/A≈üaƒüƒ±').onChange(v => snowmanGroup.position.y = v);
                fSnow.add(config, 'snowZ', -50, 50).name('ƒ∞leri/Geri').onChange(v => snowmanGroup.position.z = v);
                fSnow.add(config, 'snowScale', 1, 50).name('Boyut').onChange(v => {
                    snowmanGroup.scale.set(v,v,v);
                    snowmanGroup.children[0].scale.set(v,v,v);
                    if(snowmanGroup.children[1]) snowmanGroup.children[1].scale.set(v,v,v);
                });
            }, undefined, function(error) { console.error('Kardan adam g√∂vdesi y√ºklenirken hata olu≈ütu:', error); checkLoading(); });
            
            // 3. FENER (Orijinal Renkler)
            loader.load('lantern.glb', function(gltf) {
                lanternModel = gltf.scene;
                // MATERYAL ZORLAMA KALDIRILDI
                lanternModel.scale.set(config.lanternScale, config.lanternScale, config.lanternScale);
                lanternModel.position.set(config.lanternX, config.lanternY, config.lanternZ); 
                scene.add(lanternModel);
                checkLoading(); // Fener y√ºklendi.
                
                fLamp.add(config, 'lanternX', -50, 50).name('X Konum').onChange(v => lanternModel.position.x = v);
                fLamp.add(config, 'lanternY', -50, 20).name('Y Konum').onChange(v => lanternModel.position.y = v);
                fLamp.add(config, 'lanternZ', -50, 50).name('Z Konum').onChange(v => lanternModel.position.z = v);
                fLamp.add(config, 'lanternScale', 1, 20).name('Boyut').onChange(v => lanternModel.scale.set(v,v,v));
            }, undefined, function(error) { console.error('Fener y√ºklenirken hata olu≈ütu:', error); checkLoading(); });

            // Eski Kƒ±zak ve Geyik (Bunlarƒ± da orijinal renkleriyle y√ºkleyelim)
            const sleighGroup = new THREE.Group();
            scene.add(sleighGroup);
            loader.load('sled.glb', (g) => { 
                // MATERYAL ZORLAMA KALDIRILDI
                g.scene.scale.set(8,8,8); sleighGroup.add(g.scene); 
            }, undefined, function(error) { console.error('Kƒ±zak y√ºklenirken hata olu≈ütu:', error); });
            loader.load('reindeer.glb', (g) => { 
                // MATERYAL ZORLAMA KALDIRILDI
                g.scene.scale.set(8,8,8); g.scene.position.set(0,0,10); sleighGroup.add(g.scene); 
            }, undefined, function(error) { console.error('Geyik y√ºklenirken hata olu≈ütu:', error); });
            
            // Animasyon d√∂ng√ºs√º
            animate3D();
        }

        function animate3D() {
            requestAnimationFrame(animate3D);
            if (treeGroup) { 
                // Aƒüacƒ±n Nefes Alma Animasyonu - sadece √∂l√ßek deƒüil, rotasyon da eklendi.
                const time = performance.now() * 0.001;
                const scaleFactor = 0.005; // Daha hafif bir sallanma
                const rotationFactor = 0.0005; // √áok hafif bir rotasyon
                
                // treeGroup.rotation.y = Math.sin(time * 0.5) * rotationFactor;
                // treeGroup.rotation.z = Math.cos(time * 0.4) * rotationFactor;
            }
            if (snowmanGroup) { 
                snowmanGroup.rotation.y += 0.005; 
            } 
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            if (!camera || !renderer) return;
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        initThreeJS();
    </script>
</body>
</html>
