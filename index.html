<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YÄ±lbaÅŸÄ± Geri SayÄ±mÄ± 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

        body {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(-45deg, #0f172a, #1a0b2e, #090979, #020024);
            background-size: 400% 400%;
            animation: auroraGradient 15s ease infinite;
            overflow: hidden; margin: 0; height: 100vh; width: 100vw;
        }
        @keyframes auroraGradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        /* Parti Modu Arka PlanÄ± */
        body.party-mode {
            animation: partyGradient 2s ease infinite !important;
            background: linear-gradient(-45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);
            background-size: 600% 600%;
        }
        @keyframes partyGradient { 0% {background-position: 0% 50%} 50% {background-position: 100% 50%} 100% {background-position: 0% 50%} }

        /* YÃ¼kleme EkranÄ± */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 1); z-index: 100;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            color: #fbbf24; font-size: clamp(1rem, 3vw, 2rem); font-weight: bold; transition: opacity 0.5s;
            cursor: pointer;
        }
        
        #canvas-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; pointer-events: none; }

        /* Responsive SayaÃ§ KutularÄ± */
        .neon-box { 
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.2), inset 0 0 15px rgba(59, 130, 246, 0.1); 
            border-color: rgba(59, 130, 246, 0.3) !important; 
            background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px);
            border-radius: clamp(10px, 2vw, 20px);
            /* Esnek BoyutlandÄ±rma */
            flex: 1 1 auto;
            min-width: clamp(80px, 15vw, 200px);
            max-width: clamp(120px, 20vw, 300px);
            padding: clamp(10px, 2vw, 30px);
            margin: clamp(5px, 1vw, 20px);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: all 0.5s ease;
        }

        .digit { font-size: clamp(2rem, 8vw, 6rem); line-height: 1; font-weight: 900; }
        .label { font-size: clamp(0.6rem, 1.5vw, 1.5rem); color: rgba(191, 219, 254, 0.7); margin-top: 5px; }
        
        .hidden-box { display: none !important; } /* KutularÄ± gizlemek iÃ§in */

        /* BaÅŸlÄ±k AlanÄ± */
        .icy-headline { 
            background: linear-gradient(to right, #ffffff, #cffafe, #38bdf8); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            filter: drop-shadow(0 0 20px rgba(56, 189, 248, 0.8)); 
            font-size: clamp(1.5rem, 5vw, 4rem); 
            text-align: center; font-weight: 900; letter-spacing: 0.1em;
        }

        /* Kutlama YazÄ±sÄ± */
        .celebration-text { 
            font-size: clamp(3rem, 12vw, 8rem); 
            line-height: 1.1; font-weight: 900; text-align: center;
            background: linear-gradient(to right, #fbbf24, #ef4444, #ec4899);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.5));
            animation: zoomInBounce 1s ease-out forwards;
        }
        @keyframes zoomInBounce { 0% { transform: scale(0); opacity: 0; } 60% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

        /* IÅŸÄ±klar */
        .icicle-lights-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 45; }
        .light-string { position: absolute; top: 0; width: 2px; background-color: rgba(255, 255, 255, 0.2); }
        .light-bulb-end { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: clamp(8px, 1vw, 16px); height: clamp(12px, 1.5vw, 24px); border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; background: #fff; animation: flash 1.5s infinite alternate ease-in-out; }
        
        .light-string:nth-child(odd) { height: 10vh; } .light-string:nth-child(even) { height: 18vh; }
        .light-string:nth-child(1) { left: 10%; } .light-string:nth-child(2) { left: 30%; } .light-string:nth-child(3) { left: 50%; } .light-string:nth-child(4) { left: 70%; } .light-string:nth-child(5) { left: 90%; }
        
        .light-string:nth-child(4n+1) .light-bulb-end { background: #ff3333; box-shadow: 0 3px 10px #ff3333; } 
        .light-string:nth-child(4n+2) .light-bulb-end { background: #3366ff; box-shadow: 0 3px 10px #3366ff; } 
        @keyframes flash { 0%, 100% { opacity: 1; filter: brightness(1.5); } 50% { opacity: 0.5; filter: brightness(0.8); } }

        /* UI DÃ¼zeni */
        main { position: relative; z-index: 50; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; box-sizing: border-box; }
        #countdown-container { display: flex; flex-wrap: wrap; justify-content: center; width: 100%; max-width: 1200px; gap: clamp(10px, 2vw, 40px); }
        
        .ui-btn { position: absolute; top: 20px; right: 20px; z-index: 200; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px 16px; border-radius: 20px; backdrop-filter: blur(5px); cursor: pointer; font-size: 12px; }
    </style>
</head>
<body>

    <div id="loading-screen" onclick="forceOpen()">
        <div>ðŸŽ„ Sahne HazÄ±rlanÄ±yor...</div>
        <div style="font-size: 0.8rem; opacity: 0.7; margin-top: 10px;">(Otomatik aÃ§Ä±lmazsa tÄ±kla)</div>
    </div>

    <div id="canvas-container"></div>
    <div id="spotlight-overlay"></div>

    <div class="icicle-lights-container">
        <div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div>
        <div class="light-string"><div class="light-bulb-end"></div></div>
    </div>

    <button id="audioBtn" class="ui-btn" onclick="enableAudio()">ðŸŽµ Sesi AÃ§</button>
    <audio id="bgMusic" loop>
        <source src="mariah_its_time.mp3" type="audio/mpeg">
    </audio>

    <main>
        <div id="headline-area" class="mb-8 md:mb-12">
            <h1 class="icy-headline">YENÄ° YILA KALAN ZAMAN</h1>
        </div>

        <div id="countdown-container">
            <div id="box-days" class="neon-box">
                <span id="days" class="digit">00</span>
                <span class="label">GÃœN</span>
            </div>
            <div id="box-hours" class="neon-box">
                <span id="hours" class="digit">00</span>
                <span class="label">SAAT</span>
            </div>
            <div id="box-minutes" class="neon-box">
                <span id="minutes" class="digit">00</span>
                <span class="label">DAKÄ°KA</span>
            </div>
            <div id="box-seconds" class="neon-box">
                <span id="seconds" class="digit text-blue-300">00</span>
                <span class="label">SANÄ°YE</span>
            </div>
        </div>

        <div id="celebration" class="hidden absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
            <h2 class="celebration-text">MUTLU<br>YILLAR!</h2>
            <p class="text-xl md:text-3xl text-white mt-4 font-bold drop-shadow-lg animate-pulse">HoÅŸgeldin 2026</p>
        </div>
    </main>

    <script>
        // --- 1. SAYAÃ‡ MANTIÄžI ---
        const targetDate = new Date("Jan 1, 2026 00:00:00").getTime();
        
        const elDays = document.getElementById('days');
        const elHours = document.getElementById('hours');
        const elMinutes = document.getElementById('minutes');
        const elSeconds = document.getElementById('seconds');
        
        const boxDays = document.getElementById('box-days');
        const boxHours = document.getElementById('box-hours');
        const boxMinutes = document.getElementById('box-minutes');
        const boxSeconds = document.getElementById('box-seconds');
        
        const headlineArea = document.getElementById('headline-area');
        const countdownContainer = document.getElementById('countdown-container');
        const celebrationDiv = document.getElementById('celebration');
        
        const bgMusic = document.getElementById('bgMusic');
        let audioEnabled = false;
        let musicStarted = false;

        function enableAudio() {
            bgMusic.play().then(() => {
                bgMusic.pause();
                bgMusic.currentTime = 0;
                audioEnabled = true;
                document.getElementById('audioBtn').style.display = 'none';
            }).catch(e => console.log("Ses izni alÄ±namadÄ±"));
        }

        const timerInterval = setInterval(() => {
            const now = new Date().getTime();
            let distance = targetDate - now;

            // 4. MADDE: Son 1 saniye kala (1000ms) mÃ¼zik baÅŸlasÄ±n
            if (distance <= 1000 && distance > 0 && !musicStarted && audioEnabled) {
                bgMusic.play();
                musicStarted = true;
            }

            // 3. MADDE: SayaÃ§ eksiye dÃ¼ÅŸmesin
            if (distance < 0) {
                distance = 0;
                clearInterval(timerInterval);
                startNewYearShow(); // SayaÃ§ bitti, ÅŸovu baÅŸlat
            }

            // Hesaplamalar
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Ekrana YazdÄ±r
            elDays.innerText = days < 10 ? '0' + days : days;
            elHours.innerText = hours < 10 ? '0' + hours : hours;
            elMinutes.innerText = minutes < 10 ? '0' + minutes : minutes;
            elSeconds.innerText = seconds < 10 ? '0' + seconds : seconds;

            // 2. MADDE: Biten zaman dilimlerini gizle (Responsive DÃ¼zen)
            // EÄŸer gÃ¼n bittiyse (0 ise), gÃ¼n kutusunu kaldÄ±r.
            if (days <= 0) { 
                boxDays.classList.add('hidden-box'); 
            } else {
                boxDays.classList.remove('hidden-box');
            }

            // EÄŸer hem gÃ¼n hem saat bittiyse, saat kutusunu kaldÄ±r.
            if (days <= 0 && hours <= 0) {
                boxHours.classList.add('hidden-box');
            }

            // EÄŸer gÃ¼n, saat ve dakika bittiyse, dakika kutusunu kaldÄ±r.
            if (days <= 0 && hours <= 0 && minutes <= 0) {
                boxMinutes.classList.add('hidden-box');
                // Sadece saniye kalÄ±nca stili biraz deÄŸiÅŸtirelim (uyarÄ± rengi)
                elSeconds.classList.add('text-red-500');
            }

        }, 100);

        function startNewYearShow() {
            // 5. MADDE: Ekran DeÄŸiÅŸimi
            headlineArea.style.display = 'none';
            countdownContainer.style.display = 'none'; // SayacÄ± tamamen gizle
            celebrationDiv.classList.remove('hidden'); // KutlamayÄ± aÃ§
            
            document.body.classList.add('party-mode');
            document.querySelector('.icicle-lights-container').style.display = 'none'; // Eski Ä±ÅŸÄ±klarÄ± kaldÄ±r

            // 6. MADDE: Konfeti PatlamasÄ±
            const duration = 15 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) { return clearInterval(interval); }
                const particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random(), y: Math.random() - 0.2 } }));
            }, 250);

            // 7. MADDE: Sinematik KÄ±zak Animasyonunu Tetikle
            playSleighAnimation();
        }

        // --- 3D SAHNE & ANIMASYONLAR ---
        let scene, camera, renderer;
        let sleighGroup, cookieMan; // KÄ±zak ve Kurabiye Adam referanslarÄ±
        let sleighPath; // KÄ±zaÄŸÄ±n izleyeceÄŸi yol
        let isSleighMoving = false;
        let sleighProgress = 0;

        // YÃ¼kleme Takibi
        let itemsLoaded = 0;
        const totalItemsToLoad = 9; // AÄŸaÃ§ + Kardan Adam + Fener + 6 Hediye
        const loadingScreen = document.getElementById('loading-screen');

        function forceOpen() {
            loadingScreen.style.opacity = 0;
            setTimeout(() => loadingScreen.style.display = 'none', 500);
        }

        function checkLoading() {
            itemsLoaded++;
            if (itemsLoaded >= totalItemsToLoad) { forceOpen(); }
        }

        function initThreeJS() {
            const container = document.getElementById('canvas-container');
            
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x1a0b2e, 0.002);

            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 2000);
            updateCamera(); // Responsive Kamera AyarÄ±

            renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Performans iÃ§in
            container.appendChild(renderer.domElement);

            // IÅŸÄ±klar
            const ambientLight = new THREE.AmbientLight(0xffffff, 2.0);
            scene.add(ambientLight);
            const dirLight = new THREE.DirectionalLight(0xffd700, 3.0);
            dirLight.position.set(20, 50, 20);
            scene.add(dirLight);

            // YÄ±ldÄ±zlar
            const starGeo = new THREE.BufferGeometry();
            const starPos = new Float32Array(2000 * 3);
            for(let i=0; i<2000*3; i++) starPos[i] = (Math.random() - 0.5) * 400;
            starGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
            scene.add(new THREE.Points(starGeo, new THREE.PointsMaterial({color: 0xffffff, size: 0.3})));

            const loader = new THREE.GLTFLoader();

            // 1. AÄŸaÃ§
            loader.load('tree-decorated-snow.glb', (gltf) => {
                const model = gltf.scene;
                model.scale.set(12, 12, 12);
                model.position.set(-15, -14, 20); // Biraz sola aldÄ±k
                scene.add(model);
                checkLoading();
                loadGifts(model.position); // Hediyeleri aÄŸaca gÃ¶re yÃ¼kle
            }, undefined, checkLoading);

            // 2. Kardan Adam
            loader.load('snowman.glb', (gltf) => {
                const model = gltf.scene;
                model.scale.set(6, 6, 6);
                model.position.set(15, -10, 25);
                model.rotation.y = -0.5;
                scene.add(model);
                checkLoading();
            }, undefined, checkLoading);

            // 3. Fener
            loader.load('lantern.glb', (gltf) => {
                const model = gltf.scene;
                model.scale.set(8, 8, 8);
                model.position.set(20, -10, 22);
                scene.add(model);
                checkLoading();
            }, undefined, checkLoading);

            // --- KIZAK GRUBU (Gizli YÃ¼klenir) ---
            sleighGroup = new THREE.Group();
            sleighGroup.visible = false; // BaÅŸlangÄ±Ã§ta gÃ¶rÃ¼nmez
            scene.add(sleighGroup);

            // KÄ±zak Modeli
            loader.load('sled.glb', (gltf) => {
                const model = gltf.scene;
                model.scale.set(10, 10, 10);
                sleighGroup.add(model);
            });
            // Geyikler
            loader.load('reindeer.glb', (gltf) => {
                const deer1 = gltf.scene.clone(); deer1.scale.set(10, 10, 10); deer1.position.set(-3, 0, 12);
                const deer2 = gltf.scene.clone(); deer2.scale.set(10, 10, 10); deer2.position.set(3, 0, 12);
                sleighGroup.add(deer1); sleighGroup.add(deer2);
            });
            // Kurabiye Adam (Bize DÃ¶nÃ¼k)
            loader.load('gingerbread-man.glb', (gltf) => {
                cookieMan = gltf.scene;
                cookieMan.scale.set(30, 30, 30);
                cookieMan.position.set(0, 5, 2); 
                // Ã–NEMLÄ°: Math.PI ile 180 derece dÃ¶ndÃ¼rÃ¼yoruz, bize bakÄ±yor.
                cookieMan.rotation.y = Math.PI; 
                sleighGroup.add(cookieMan);
            });

            // --- KIZAK ROTASI (7. Madde) ---
            // Uzaktan baÅŸlar, kavisli gelir, yukarÄ±dan Ã§Ä±kar
            const pathPoints = [
                new THREE.Vector3(200, 50, -400), // BaÅŸlangÄ±Ã§ (Uzak SaÄŸ)
                new THREE.Vector3(50, 20, -100),  // YaklaÅŸma
                new THREE.Vector3(0, 5, 40),      // Sahne Ã–nÃ¼ (En YakÄ±n)
                new THREE.Vector3(-150, 80, -100) // Ã‡Ä±kÄ±ÅŸ (Sol Ãœst Arka)
            ];
            sleighPath = new THREE.CatmullRomCurve3(pathPoints);

            animate();
        }

        function loadGifts(treePos) {
            const loader = new THREE.GLTFLoader();
            const giftFiles = ['present-a-cube.glb', 'present-a-rectangle.glb', 'present-b-round.glb'];
            
            for(let i=0; i < 6; i++) {
                const file = giftFiles[Math.floor(Math.random() * giftFiles.length)];
                loader.load(file, (gltf) => {
                    const gift = gltf.scene;
                    gift.scale.set(4, 4, 4);
                    // AÄŸacÄ±n etrafÄ±na rastgele daÄŸÄ±t
                    const angle = Math.random() * Math.PI * 2;
                    const radius = 4 + Math.random() * 4;
                    gift.position.set(
                        treePos.x + Math.cos(angle) * radius,
                        -11.5, // Zemin seviyesi
                        treePos.z + Math.sin(angle) * radius
                    );
                    gift.rotation.y = Math.random();
                    scene.add(gift);
                    checkLoading(); // Hediye yÃ¼klendi, sayacÄ± artÄ±r
                }, undefined, checkLoading);
            }
        }

        function playSleighAnimation() {
            if (sleighGroup) {
                sleighGroup.visible = true;
                isSleighMoving = true;
                sleighProgress = 0;
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // KÄ±zak Hareketi (Tek Seferlik)
            if (isSleighMoving && sleighGroup) {
                sleighProgress += 0.003; // HÄ±z AyarÄ±
                if (sleighProgress >= 1) {
                    sleighProgress = 1;
                    isSleighMoving = false;
                    sleighGroup.visible = false; // Sahneden Ã§Ä±kar
                }

                const position = sleighPath.getPoint(sleighProgress);
                sleighGroup.position.copy(position);

                // KÄ±zaÄŸÄ±n burnu yola baksÄ±n
                const tangent = sleighPath.getTangent(sleighProgress).normalize();
                const lookAtPos = position.clone().add(tangent);
                sleighGroup.lookAt(lookAtPos);
                
                // Kurabiye adam zaten gruba ters ekli olduÄŸu iÃ§in, grup dÃ¶nÃ¼nce o da bize bakmaya devam eder (veya el sallar gibi gÃ¶rÃ¼nÃ¼r)
            }

            renderer.render(scene, camera);
        }

        // --- RESPONSIVE KAMERA ---
        function updateCamera() {
            if (!camera || !renderer) return;
            const w = window.innerWidth;
            const h = window.innerHeight;
            
            renderer.setSize(w, h);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();

            // Mobilde kamerayÄ± biraz geri Ã§ekelim ki her ÅŸey sÄ±ÄŸsÄ±n
            if (w < 768) {
                camera.position.set(0, 5, 90);
            } else {
                camera.position.set(0, 0, 60);
            }
        }

        window.addEventListener('resize', updateCamera);
        window.addEventListener('load', initThreeJS);

    </script>
</body>
</html>
